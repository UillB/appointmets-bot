<div class="telegram-webapp" [class.telegram-theme]="isTelegramWebApp">
  <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
  <div class="loading-section" *ngIf="isLoading">
    <mat-spinner diameter="40"></mat-spinner>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</p>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <div class="main-content" *ngIf="!isLoading">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
      <h1>ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</h1>
      <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</p>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (—Ç–æ–ª—å–∫–æ –≤ Telegram WebApp) -->
    <mat-card class="user-info-card" *ngIf="isTelegramWebApp && getUserInfo()">
      <mat-card-content>
        <div class="user-info">
          <mat-icon>person</mat-icon>
          <div class="user-details">
            <h3>{{ getUserInfo().firstName }} {{ getUserInfo().lastName }}</h3>
            <p *ngIf="getUserInfo().username">@{{ getUserInfo().username }}</p>
            <mat-chip-listbox>
              <mat-chip *ngIf="getUserInfo().isPremium" color="accent" selected>
                Premium
              </mat-chip>
              <mat-chip color="primary" selected>
                {{ getUserInfo().languageCode?.toUpperCase() || 'RU' }}
              </mat-chip>
            </mat-chip-listbox>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- –í–∫–ª–∞–¥–∫–∏ -->
    <mat-tab-group 
      [(selectedIndex)]="selectedTabIndex" 
      (selectedIndexChange)="onTabChange($event)"
      class="webapp-tabs">
      
      <!-- –í–∫–ª–∞–¥–∫–∞ 1: –ó–∞–ø–∏—Å—å –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é -->
      <mat-tab>
        <ng-template mat-tab-label>
          <div class="tab-label">
            <mat-icon>event_available</mat-icon>
            <span>–ó–∞–ø–∏—Å—å</span>
          </div>
        </ng-template>
        
        <div class="tab-content">
          <mat-card class="booking-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>calendar_today</mat-icon>
                –ó–∞–ø–∏—Å—å –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
              </mat-card-title>
              <mat-card-subtitle>
                –í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
              </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
              <div class="booking-info">
                <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é:</p>
                <ul>
                  <li>–í—ã–±–æ—Ä —É—Å–ª—É–≥–∏</li>
                  <li>–í—ã–±–æ—Ä –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏</li>
                  <li>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏</li>
                </ul>
                
                <div class="coming-soon">
                  <mat-icon>construction</mat-icon>
                  <p>–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>

      <!-- –í–∫–ª–∞–¥–∫–∞ 2: –ú–æ–∏ –∑–∞–ø–∏—Å–∏ -->
      <mat-tab>
        <ng-template mat-tab-label>
          <div class="tab-label">
            <mat-icon>event_note</mat-icon>
            <span>–ú–æ–∏ –∑–∞–ø–∏—Å–∏</span>
          </div>
        </ng-template>
        
        <div class="tab-content">
          <mat-card class="appointments-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>schedule</mat-icon>
                –ú–æ–∏ –∑–∞–ø–∏—Å–∏
              </mat-card-title>
              <mat-card-subtitle>
                –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º–∏ –∑–∞–ø–∏—Å—è–º–∏
              </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
              <div class="appointments-info">
                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—à–∏ –∑–∞–ø–∏—Å–∏:</p>
                <ul>
                  <li>–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</li>
                  <li>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å–µ–π</li>
                  <li>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã</li>
                </ul>
                
                <div class="coming-soon">
                  <mat-icon>construction</mat-icon>
                  <p>–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>

      <!-- –í–∫–ª–∞–¥–∫–∞ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <mat-tab>
        <ng-template mat-tab-label>
          <div class="tab-label">
            <mat-icon>settings</mat-icon>
            <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
          </div>
        </ng-template>
        
        <div class="tab-content">
          <mat-card class="settings-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>tune</mat-icon>
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
              </mat-card-title>
              <mat-card-subtitle>
                –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
              </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
              <div class="settings-info">
                <p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</p>
                <ul>
                  <li>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                  <li>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</li>
                  <li>–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å</li>
                </ul>
                
                <div class="coming-soon">
                  <mat-icon>construction</mat-icon>
                  <p>–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>
    </mat-tab-group>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ -->
    <mat-card class="bot-info-card" *ngIf="botStatus?.botStatus">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>info</mat-icon>
          –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
        </mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <div class="bot-info">
          <div class="info-item">
            <mat-icon>person</mat-icon>
            <div class="info-text">
              <h4>–ò–º—è –±–æ—Ç–∞</h4>
              <p>{{ botStatus?.botStatus?.firstName || '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}</p>
            </div>
          </div>

          <div class="info-item">
            <mat-icon>alternate_email</mat-icon>
            <div class="info-text">
              <h4>Username</h4>
              <p>@{{ botStatus?.botStatus?.username || '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}</p>
            </div>
          </div>

          <div class="info-item">
            <mat-icon>link</mat-icon>
            <div class="info-text">
              <h4>–°—Å—ã–ª–∫–∞</h4>
              <p>{{ botStatus?.botStatus?.botLink || '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}</p>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
