# src/bot/mw/i18n.ts

```ts
import { Context, MiddlewareFn } from "telegraf";
import { detectLang, t, Lang } from "../../i18n";

declare module "telegraf" {
  interface Context {
    lang: Lang;
    tt: (key: string, params?: Record<string, any>) => string;
  }
}

export const i18nMw: MiddlewareFn<Context> = async (ctx, next) => {
  const code = ctx.from?.language_code;
  ctx.lang = detectLang(code);
  ctx.tt = (key, params) => t(ctx.lang, key, params ?? {});
  return next();
};

```
